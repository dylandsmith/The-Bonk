<div id="my_bonks" class="city">
  <section class="display-header-container">
    <div class="display-header-grid">
      <div class="display-title">Title</div>
      <div class="display-year">Year</div>
      <div class="display-est-budget">Estimated Budget</div>
      <div class="display-gross">Worldwide Gross</div>
      <div class="display-details">Details</div>
      <div class="display-fav">&nbsp</div>
    </div>
  </section>
  <section class="movie-display-sheet">
    <%# binding.pry %>
    <% if @popular_flops_json.nil? ? @movies = @user_favorites : @movies = @popular_flops_json %>
    <%# binding.pry %>
    <% end %>
    <% @movies.each do |movie| %>
      <details>
        <summary>
          <div class="movie-line-item">
            <div class="movie-line-item-title"><%= movie.favoritable.title %></div>
            <div class="movie-line-item-year"><%= movie.favoritable.year_released %></div>
            <div class="movie-line-item-est-budget"><%= movie.favoritable.budget %></div>
            <div class="movie-line-item-gross"><%= movie.favoritable.worldwide_gross %></div>
            <div class="movie-line-item-details">
              <% if movie.favoritable.imdb_id %>
              <%= link_to movie_path(movie.favoritable), class: 'film-link' do %>
              <%= fa_icon 'film', class: 'icon'%>
              <% end %>
              <% end %>
            </div>
            <div class="movie-line-item-fav" data-controller="favorites" data-action="click->favorites#addToFavorites" data-favorites-movie-id-param="<%= movie.id %>" data-favorites-user-id-param="<%= Current.user.id %>" data-favorites-fav-type-param="movie">
              <% if (movie.user_id == Current.user.id ) %>
              <div class="favorite-movie">
                <%= fa_icon 'thumbs-up', class: 'icon'%>
              </div>
              <% else %>
              <div class="favorite-thumb">
                <%= fa_icon 'thumbs-up', class: 'icon'%>
              </div>
              <% end %>
            </div>
          </div>
        </summary>
        <div data-controller="add-movie-post" class="movie-post-actions" data-add-movie-post-length="<%= @user_favorites.length %>">
          <div data-action="click->add-movie-post#postComment" class="add-post"><%= fa_icon 'plus' %></div>
          <div style="clear: both;"></div>
          <div class="modal" data-controller="modal" data-add-movie-post-target="<%= 'source' + movie.favoritable.id.to_s %>">
            <div class="modal-container">
              <div class="modal-header">
                <span class="modal-title"><%= fa_icon 'comment' %>&nbsp;Post a comment for <%= movie.favoritable.title %></span>
                <span class="modal-close" data-action="click->modal#close"><%= fa_icon 'window-close 2x' %></span>
                <div style="clear:both;"></div>
              </div>
              <div class="modal-content">
                <%= form_with(model: @post, url: posts_path) do |form| %>
                <%= form.text_field :title, placeholder: 'Title', class: 'modal-post-title' %>
                <%= form.text_area :body, placeholder: 'Comment', class: 'modal-post-body' %>
                <%#= form.hidden_field :user_id, value: Current.user.id %>
                <%= form.hidden_field :movie_id, value: movie.id %>
                <!-- <textarea class="modal-post-body"></textarea> -->
              </div>
              <div class="modal-footer">
                <%= form.submit 'Submit Post', class: 'submit-post-btn' %>
                <%#= button_tag class: 'submit-post-btn' do %>
                <!--Submit Post<%#= fa_icon 'search' %>-->
                <%# end %>
              </div>
              <% end %>
            </div>
          </div>
        </div>
        <% movie.favoritable.posts.each do |post| %>
        <div class="movie-post">
          <div class="movie-post-header">
            <p><%= post.title %></p>
            <%= fa_icon 'comment 2x' %>
          </div>
          <div class="movie-post-body">
            <p><%= post.body %></p>
          </div>
        </div>
        <% end %>
      </details>
    <% end %>
  </section>
</div>

<div id="popular_bonks" class="city" style="display:none">
  <h2>Paris</h2>
  <p>Paris is the capital of France.</p>
</div>

<div id="Tokyo" class="city" style="display:none">
  <h2>Tokyo</h2>
  <p>Tokyo is the capital of Japan.</p>
</div>