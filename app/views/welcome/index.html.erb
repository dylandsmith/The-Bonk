<script type="text/javascript">
  function openCity(cityName) {
    var i;
    var x = document.getElementsByClassName("city");
    for (i = 0; i < x.length; i++) {
      x[i].style.display = "none";
    }
    document.getElementById(cityName).style.display = "block";
  }
</script>
<div class="welcome-grid">
  <section class="welcome-grid-title">
    <% if Current.user %>
    <section class="header-grid">
      <div class="welcome-search">
        <%= render 'movies/search_movies' %>
      </div>
      <div class="welcome-recommendation">
        <%#= button_to 'Add Recommendation', new_movie_path, method: :get, class: 'recommendation-btn' %>
      </div>
    </section>
    <% end %>
  </section>
  <% if Current.user %>
  <section class="welcome-main">
    <section class="tab-navigation">
      <%= link_to "My Bonks",
                root_path,
                data: { turbo_frame: "tab-content" },
                class: "recommendation-btn", turbo_scroll: false %>

      <%= link_to "Popular Bonks",
                flops_path,
                data: { turbo_frame: "tab-content" },
                class: "recommendation-btn", turbo_scroll: false %>

      <%= link_to "Add Recommendation",
                recommendations_path,
                data: { turbo_frame: "tab-content" },
                class: "recommendation-btn", turbo_scroll: false %>
    </section>
    <section class="main-content">
      <turbo-frame id="tab-content">
        <%= render partial: "movies/movie_table_display", locals: { movies: @user_favorites } %>
      </turbo-frame>
    </section>


    <% else %>
    <article>
      <p>The road to hell is paved with good intentions. While film makers strive to create masterpieces,
        often the film's gross profits fall well below what it took to make and advertise the film. That doesn't mean that the film is bad.</p>
      <p>Many cult classics were box office flops. Some films went on to make more money in video/streaming services.
        Word of mouth can give a film new legs and sometimes it just takes a while for a film to build an audience.</p>
    </article>

    <span class="table-caption">Current Popular Flops</span>
    <hr>
    <br>
    <div class="table-back-drop">
      <table class="table table-dark">
        <thead>
          <tr>
            <th>Title</th>
            <th>Year</th>
            <th> Estimated Budget</th>
            <th>Worldwide Gross</th>
            <th>Details</th>
          </tr>
        </thead>
        <tbody>
          <% @popular_flops.each do |movie| %>
          <tr>
            <td><%= movie.title %></td>
            <td><%= movie.year_released %></td>
            <td><%= movie.budget %></td>
            <td><%= movie.worldwide_gross %></td>
            <td><% if movie.imdb_id %>
              <%= link_to movies_path(movie_id: movie.id), class: 'film-link' do %>
              <%= fa_icon 'film', class: 'icon'%>
              <% end %>
              <% end %>
            </td>
          </tr>
          <% end %>
        </tbody>
      </table>
    </div>
    <% end %>
  </section>
  <section class="user_info">
    <%= render 'shared/user_panel' %>
  </section>
</div>